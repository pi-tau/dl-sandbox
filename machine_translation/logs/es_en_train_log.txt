------------------------------------------------------------
Training a model to translate from es to en.
------------------------------------------------------------

Reading training data from datasets/es_en_data/ ...
Using device: cuda
Begin training..
Epoch (1/100), train time: 18.36 min, avg loss: 182.6, avg train ppl: 5906.6, dev ppl: 12206.0
saving the new best model to [bin/model_es_en.bin]..
Epoch (2/100), train time: 20.47 min, avg loss: 213.6, avg train ppl: 9814.8, dev ppl: 6615.6
saving the new best model to [bin/model_es_en.bin]..
Epoch (3/100), train time: 19.34 min, avg loss: 210.6, avg train ppl: 10236.7, dev ppl: 4977.5
saving the new best model to [bin/model_es_en.bin]..
Epoch (4/100), train time: 19.80 min, avg loss: 136.2, avg train ppl: 2471.3, dev ppl: 4191.9
saving the new best model to [bin/model_es_en.bin]..
Epoch (5/100), train time: 19.55 min, avg loss: 142.8, avg train ppl: 2172.3, dev ppl: 3668.7
saving the new best model to [bin/model_es_en.bin]..
Epoch (6/100), train time: 19.60 min, avg loss: 170.3, avg train ppl: 5909.5, dev ppl: 3418.8
saving the new best model to [bin/model_es_en.bin]..
Epoch (7/100), train time: 20.24 min, avg loss: 169.1, avg train ppl: 3488.2, dev ppl: 3220.6
saving the new best model to [bin/model_es_en.bin]..
Epoch (8/100), train time: 19.80 min, avg loss: 136.1, avg train ppl: 2706.2, dev ppl: 2674.8
saving the new best model to [bin/model_es_en.bin]..
Epoch (9/100), train time: 19.83 min, avg loss: 164.6, avg train ppl: 871.9, dev ppl: 546.6
saving the new best model to [bin/model_es_en.bin]..
Epoch (10/100), train time: 19.71 min, avg loss: 120.7, avg train ppl: 417.5, dev ppl: 360.3
saving the new best model to [bin/model_es_en.bin]..
Epoch (11/100), train time: 19.57 min, avg loss: 114.0, avg train ppl: 279.3, dev ppl: 278.1
saving the new best model to [bin/model_es_en.bin]..
Epoch (12/100), train time: 19.35 min, avg loss: 138.7, avg train ppl: 250.1, dev ppl: 249.6
saving the new best model to [bin/model_es_en.bin]..
Epoch (13/100), train time: 19.59 min, avg loss: 115.4, avg train ppl: 401.6, dev ppl: 231.6
saving the new best model to [bin/model_es_en.bin]..
Epoch (14/100), train time: 19.09 min, avg loss: 105.7, avg train ppl: 228.8, dev ppl: 219.5
saving the new best model to [bin/model_es_en.bin]..
Epoch (15/100), train time: 19.81 min, avg loss: 106.7, avg train ppl: 227.8, dev ppl: 207.8
saving the new best model to [bin/model_es_en.bin]..
Epoch (16/100), train time: 19.97 min, avg loss: 105.6, avg train ppl: 234.4, dev ppl: 200.5
saving the new best model to [bin/model_es_en.bin]..
Epoch (17/100), train time: 19.93 min, avg loss: 116.1, avg train ppl: 247.4, dev ppl: 182.1
saving the new best model to [bin/model_es_en.bin]..
Epoch (18/100), train time: 19.98 min, avg loss: 99.0, avg train ppl: 156.6, dev ppl: 184.4
increasing patience = 1
Epoch (19/100), train time: 19.59 min, avg loss: 119.8, avg train ppl: 296.3, dev ppl: 180.5
saving the new best model to [bin/model_es_en.bin]..
Epoch (20/100), train time: 19.59 min, avg loss: 110.2, avg train ppl: 214.0, dev ppl: 177.6
saving the new best model to [bin/model_es_en.bin]..
Epoch (21/100), train time: 19.38 min, avg loss: 116.0, avg train ppl: 222.2, dev ppl: 170.8
saving the new best model to [bin/model_es_en.bin]..
Epoch (22/100), train time: 19.53 min, avg loss: 103.0, avg train ppl: 256.4, dev ppl: 169.5
saving the new best model to [bin/model_es_en.bin]..
Epoch (23/100), train time: 19.93 min, avg loss: 107.0, avg train ppl: 171.0, dev ppl: 165.0
saving the new best model to [bin/model_es_en.bin]..
Epoch (24/100), train time: 19.84 min, avg loss: 97.7, avg train ppl: 107.7, dev ppl: 162.3
saving the new best model to [bin/model_es_en.bin]..
Epoch (25/100), train time: 18.95 min, avg loss: 106.7, avg train ppl: 143.6, dev ppl: 154.7
saving the new best model to [bin/model_es_en.bin]..
Epoch (26/100), train time: 19.69 min, avg loss: 96.0, avg train ppl: 124.6, dev ppl: 158.2
increasing patience = 1
Epoch (27/100), train time: 19.45 min, avg loss: 108.1, avg train ppl: 197.9, dev ppl: 159.8
increasing patience = 2
Epoch (28/100), train time: 19.80 min, avg loss: 123.8, avg train ppl: 293.9, dev ppl: 162.3
increasing patience = 3
Epoch (29/100), train time: 19.11 min, avg loss: 87.5, avg train ppl: 122.3, dev ppl: 159.3
increasing patience = 4
Epoch (30/100), train time: 18.82 min, avg loss: 103.2, avg train ppl: 130.0, dev ppl: 156.0
increasing patience = 5
increasing num trial: 1
Epoch (31/100), train time: 18.93 min, avg loss: 120.1, avg train ppl: 180.2, dev ppl: 118.6
saving the new best model to [bin/model_es_en.bin]..
Epoch (32/100), train time: 19.13 min, avg loss: 114.7, avg train ppl: 188.8, dev ppl: 116.9
saving the new best model to [bin/model_es_en.bin]..
Epoch (33/100), train time: 13.62 min, avg loss: 85.7, avg train ppl: 82.9, dev ppl: 114.2
saving the new best model to [bin/model_es_en.bin]..
Epoch (34/100), train time: 13.50 min, avg loss: 66.9, avg train ppl: 49.6, dev ppl: 114.3
increasing patience = 1
Epoch (35/100), train time: 13.49 min, avg loss: 96.4, avg train ppl: 73.6, dev ppl: 114.7
increasing patience = 2
Epoch (36/100), train time: 13.48 min, avg loss: 94.1, avg train ppl: 101.9, dev ppl: 110.6
saving the new best model to [bin/model_es_en.bin]..
Epoch (37/100), train time: 13.52 min, avg loss: 86.0, avg train ppl: 92.4, dev ppl: 110.6
increasing patience = 1
Epoch (38/100), train time: 13.42 min, avg loss: 83.8, avg train ppl: 83.1, dev ppl: 109.8
saving the new best model to [bin/model_es_en.bin]..
Epoch (39/100), train time: 13.44 min, avg loss: 94.5, avg train ppl: 145.7, dev ppl: 109.5
saving the new best model to [bin/model_es_en.bin]..
Epoch (40/100), train time: 13.44 min, avg loss: 88.1, avg train ppl: 64.1, dev ppl: 106.8
saving the new best model to [bin/model_es_en.bin]..
Epoch (41/100), train time: 13.47 min, avg loss: 93.4, avg train ppl: 74.6, dev ppl: 107.2
increasing patience = 1
Epoch (42/100), train time: 13.45 min, avg loss: 79.9, avg train ppl: 72.1, dev ppl: 105.7
saving the new best model to [bin/model_es_en.bin]..
Epoch (43/100), train time: 13.44 min, avg loss: 95.5, avg train ppl: 104.4, dev ppl: 108.9
increasing patience = 1
Epoch (44/100), train time: 13.52 min, avg loss: 99.3, avg train ppl: 156.3, dev ppl: 103.8
saving the new best model to [bin/model_es_en.bin]..
Epoch (45/100), train time: 13.51 min, avg loss: 86.4, avg train ppl: 75.5, dev ppl: 105.3
increasing patience = 1
Epoch (46/100), train time: 13.45 min, avg loss: 96.0, avg train ppl: 114.0, dev ppl: 107.1
increasing patience = 2
Epoch (47/100), train time: 13.45 min, avg loss: 102.0, avg train ppl: 103.4, dev ppl: 106.1
increasing patience = 3
Epoch (48/100), train time: 13.44 min, avg loss: 83.7, avg train ppl: 93.4, dev ppl: 104.9
increasing patience = 4
Epoch (49/100), train time: 13.46 min, avg loss: 110.0, avg train ppl: 88.5, dev ppl: 105.6
increasing patience = 5
increasing num trial: 2
Epoch (50/100), train time: 13.44 min, avg loss: 106.4, avg train ppl: 111.3, dev ppl: 92.5
saving the new best model to [bin/model_es_en.bin]..
Epoch (51/100), train time: 13.45 min, avg loss: 84.7, avg train ppl: 48.6, dev ppl: 91.7
saving the new best model to [bin/model_es_en.bin]..
Epoch (52/100), train time: 13.46 min, avg loss: 94.5, avg train ppl: 81.5, dev ppl: 91.2
saving the new best model to [bin/model_es_en.bin]..
Epoch (53/100), train time: 13.42 min, avg loss: 86.5, avg train ppl: 83.4, dev ppl: 90.9
saving the new best model to [bin/model_es_en.bin]..
Epoch (54/100), train time: 13.47 min, avg loss: 90.1, avg train ppl: 72.0, dev ppl: 92.4
increasing patience = 1
Epoch (55/100), train time: 13.44 min, avg loss: 93.9, avg train ppl: 68.4, dev ppl: 90.5
saving the new best model to [bin/model_es_en.bin]..
Epoch (56/100), train time: 13.46 min, avg loss: 75.0, avg train ppl: 38.4, dev ppl: 92.3
increasing patience = 1
Epoch (57/100), train time: 13.44 min, avg loss: 104.3, avg train ppl: 116.8, dev ppl: 89.3
saving the new best model to [bin/model_es_en.bin]..
Epoch (58/100), train time: 13.47 min, avg loss: 100.6, avg train ppl: 93.5, dev ppl: 88.5
saving the new best model to [bin/model_es_en.bin]..
Epoch (59/100), train time: 13.44 min, avg loss: 96.6, avg train ppl: 77.5, dev ppl: 88.9
increasing patience = 1
Epoch (60/100), train time: 13.44 min, avg loss: 86.2, avg train ppl: 71.9, dev ppl: 89.6
increasing patience = 2
Epoch (61/100), train time: 13.45 min, avg loss: 94.0, avg train ppl: 105.7, dev ppl: 87.4
saving the new best model to [bin/model_es_en.bin]..
Epoch (62/100), train time: 13.47 min, avg loss: 89.1, avg train ppl: 65.1, dev ppl: 86.8
saving the new best model to [bin/model_es_en.bin]..
Epoch (63/100), train time: 13.44 min, avg loss: 93.8, avg train ppl: 97.8, dev ppl: 87.6
increasing patience = 1
Epoch (64/100), train time: 13.44 min, avg loss: 83.8, avg train ppl: 74.7, dev ppl: 87.6
increasing patience = 2
Epoch (65/100), train time: 13.46 min, avg loss: 110.1, avg train ppl: 157.7, dev ppl: 86.5
saving the new best model to [bin/model_es_en.bin]..
Epoch (66/100), train time: 13.44 min, avg loss: 90.6, avg train ppl: 76.0, dev ppl: 88.2
increasing patience = 1
Epoch (67/100), train time: 14.50 min, avg loss: 85.2, avg train ppl: 76.7, dev ppl: 88.7
increasing patience = 2
Epoch (68/100), train time: 19.16 min, avg loss: 69.0, avg train ppl: 61.1, dev ppl: 87.1
increasing patience = 3
Epoch (69/100), train time: 18.69 min, avg loss: 96.0, avg train ppl: 87.1, dev ppl: 87.0
increasing patience = 4
Epoch (70/100), train time: 18.72 min, avg loss: 86.9, avg train ppl: 65.2, dev ppl: 84.9
saving the new best model to [bin/model_es_en.bin]..
Epoch (71/100), train time: 18.91 min, avg loss: 77.6, avg train ppl: 38.8, dev ppl: 86.4
increasing patience = 1
Epoch (72/100), train time: 19.09 min, avg loss: 108.0, avg train ppl: 74.5, dev ppl: 85.5
increasing patience = 2
Epoch (73/100), train time: 19.23 min, avg loss: 93.4, avg train ppl: 60.3, dev ppl: 87.2
increasing patience = 3
Epoch (74/100), train time: 18.84 min, avg loss: 85.1, avg train ppl: 73.5, dev ppl: 86.6
increasing patience = 4
Epoch (75/100), train time: 18.94 min, avg loss: 99.5, avg train ppl: 129.8, dev ppl: 85.6
increasing patience = 5
increasing num trial: 3
Epoch (76/100), train time: 18.81 min, avg loss: 92.6, avg train ppl: 76.3, dev ppl: 81.7
saving the new best model to [bin/model_es_en.bin]..
Epoch (77/100), train time: 19.77 min, avg loss: 52.7, avg train ppl: 23.7, dev ppl: 82.5
increasing patience = 1
Epoch (78/100), train time: 19.01 min, avg loss: 55.6, avg train ppl: 33.3, dev ppl: 81.7
saving the new best model to [bin/model_es_en.bin]..
Epoch (79/100), train time: 19.32 min, avg loss: 82.2, avg train ppl: 67.2, dev ppl: 80.7
saving the new best model to [bin/model_es_en.bin]..
Epoch (80/100), train time: 18.87 min, avg loss: 96.9, avg train ppl: 70.6, dev ppl: 80.9
increasing patience = 1
Epoch (81/100), train time: 19.01 min, avg loss: 89.5, avg train ppl: 66.4, dev ppl: 81.1
increasing patience = 2
Epoch (82/100), train time: 19.21 min, avg loss: 79.4, avg train ppl: 49.1, dev ppl: 80.8
increasing patience = 3
Epoch (83/100), train time: 18.95 min, avg loss: 66.3, avg train ppl: 56.6, dev ppl: 81.2
increasing patience = 4
Epoch (84/100), train time: 18.90 min, avg loss: 60.1, avg train ppl: 31.9, dev ppl: 80.9
increasing patience = 5
increasing num trial: 4
Epoch (85/100), train time: 19.00 min, avg loss: 70.8, avg train ppl: 42.5, dev ppl: 79.1
saving the new best model to [bin/model_es_en.bin]..
Epoch (86/100), train time: 19.34 min, avg loss: 71.7, avg train ppl: 54.0, dev ppl: 79.3
increasing patience = 1
Epoch (87/100), train time: 19.21 min, avg loss: 69.4, avg train ppl: 47.1, dev ppl: 78.4
saving the new best model to [bin/model_es_en.bin]..
Epoch (88/100), train time: 19.04 min, avg loss: 82.9, avg train ppl: 44.6, dev ppl: 78.9
increasing patience = 1
Epoch (89/100), train time: 19.27 min, avg loss: 74.0, avg train ppl: 47.4, dev ppl: 79.0
increasing patience = 2
Epoch (90/100), train time: 18.66 min, avg loss: 62.2, avg train ppl: 27.5, dev ppl: 79.2
increasing patience = 3
Epoch (91/100), train time: 18.94 min, avg loss: 70.0, avg train ppl: 32.8, dev ppl: 78.7
increasing patience = 4
Epoch (92/100), train time: 18.86 min, avg loss: 82.2, avg train ppl: 49.2, dev ppl: 78.9
increasing patience = 5
increasing num trial: 5
Epoch (93/100), train time: 19.02 min, avg loss: 88.8, avg train ppl: 65.4, dev ppl: 77.5
saving the new best model to [bin/model_es_en.bin]..
Epoch (94/100), train time: 19.18 min, avg loss: 87.9, avg train ppl: 58.6, dev ppl: 77.4
saving the new best model to [bin/model_es_en.bin]..
Epoch (95/100), train time: 19.27 min, avg loss: 78.9, avg train ppl: 47.9, dev ppl: 77.5
increasing patience = 1
Epoch (96/100), train time: 18.96 min, avg loss: 92.4, avg train ppl: 73.6, dev ppl: 77.9
increasing patience = 2
Epoch (97/100), train time: 18.64 min, avg loss: 69.0, avg train ppl: 35.6, dev ppl: 78.1
increasing patience = 3
Epoch (98/100), train time: 19.25 min, avg loss: 83.9, avg train ppl: 35.6, dev ppl: 77.5
increasing patience = 4
Epoch (99/100), train time: 19.25 min, avg loss: 66.4, avg train ppl: 44.7, dev ppl: 77.4
saving the new best model to [bin/model_es_en.bin]..
Epoch (100/100), train time: 19.37 min, avg loss: 103.0, avg train ppl: 68.4, dev ppl: 78.1
increasing patience = 1
Reached maximum number of epochs!
loading the best performing model..
Training took 1729.230 minutes
Computing corpuse level BLEU score..
Corpus BLEU: 13.729. Computed in 112.987 seconds.
